<ion-view view-title="VGN Departures">

  <ion-content>
    <div class="item item-input-inset">
      <label class="item-input-wrapper">
        <i class="icon ion-ios-search placeholder-icon"></i>
        <input id="search" type="search" placeholder="Search" ng-change="search()" ng-focus="scrollTop()" ng-value="station.id" ng-model="station.name">

        <form name="search_form" ng-submit="clearSearch()">
          <button class="button button-small button-clear" ng-click="clearSearch()">
            <i class="icon ion-android-cancel"></i>
          </button>
        </form>

      </label>

      <button class="button button-clear no-margin" ng-class="{energized: favorite}" ng-click="favorite ? removeFavorite(station) : addFavorite(station)">
        <i class="icon ion-star" ng-class="{energized: favorite}"></i>
      </button>
    </div>


    <ul class="tags" ng-if="tags.length > 0">
      <li>Filters:</li>
    	<li ng-repeat="tag in tags track by $index" ng-click="removeTag(tag)">
        <a href="#">{{tag.name}}
          <i class="icon ion-close-circled"></i>
        </a>
      </li>
    </ul>

    <div class="list no-margin no-padding" ng-if="suggestions">
      <li class="item" ng-repeat="suggestion in suggestions" ng-click="loadDepartures(suggestion)">
        {{suggestion.name}}
      </li>
    </div>

    <div class="list no-margin no-padding" ng-if="favorites">
      <li class="item" ng-repeat="favorite in favorites" ng-click="loadDepartures(favorite)">
        <i class= "icon ion-star energized"></i>
        {{favorite.name}}
      </li>
    </div>

    <div class="item item-divider" ng-if="departures">
      {{ clock }} Departures
    </div>

    <div class="list">
      <li class="item item-avatar" ng-repeat="departure in departures | limitTo:15">
        <span class="item-transport {{departure.transport}} {{departure.line}}" ng-click="addTag({ type: 'line', name: departure.line }); scrollTop()">
          {{departure.line}}
        </span>
        <h2>
          <i class="icon ion-ios-navigate-outline dark"></i>

          <a href="#" class="dark bold" ng-click="addTag({ type: 'direction', name: departure.direction}); scrollTop()">
            {{ departure.direction }}
          </a>
        </h2>
        <p>
          <i class="icon ion-clock " ng-class="{ assertive: departure.delay != 0}"></i>
          {{ departure.time() }}
          <span ng-if="departure.delay != 0">({{ departure.delay }})</span>
        </p>
        <span class="badge badge-assertive no-bold">{{ departure.time_left() }}</span>
      </li>
    </div>

  </ion-content>
</ion-view>
